{"version":3,"file":"index-96d66bf1.js","sources":["../../../src/utils/transfer2blob.ts","../../../src/pages/demo/qrcode/index.vue"],"sourcesContent":["/**\n * @description url转换为blob类型\n */\nexport const urlToBlob = (theUrl: string, callback: any) => {\n  const xhr = new XMLHttpRequest(); // 初始化实例对象\n  xhr.open('get', theUrl, true); // 初始化一个异步请求\n  xhr.responseType = 'blob'; // 实例返回类型/ArrayBuffer/Blob/Document;\n  xhr.onload = function () {\n    if (this.status === 200) {\n      if (callback) {\n        callback(this.response);\n      }\n    }\n  };\n  xhr.send();\n};\n/**\n * @description base64转换为blob类型\n */\nexport const base64ToBlob = (code: string) => {\n  const parts = code.split(';base64,');\n  const contentType = parts[0].split(':')[1];\n  const raw = window.atob(parts[1]);\n  const rawLength = raw.length;\n  const uInt8Array = new Uint8Array(rawLength);\n  for (let i = 0; i < rawLength; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n  return new Blob([uInt8Array], { type: contentType });\n};\n\nexport default {\n  base64ToBlob,\n  urlToBlob\n};\n","<template>\n  <div class=\"qrcode-container\">\n    <div class=\"info\">\n      <t-divider content-position=\"left\">生成二维码</t-divider>\n      <span style=\"text-align: left\">\n        生成二维码通常用来做前台海报生成或者后台活动营销推广码配置\n      </span>\n    </div>\n    <div class=\"grid-content bg-purple-dark\">\n      <t-card class=\"box-card\">\n        <div style=\"text-align: left\">\n          <span>后台活动营销配置推广码场景</span>\n          <t-divider></t-divider>\n        </div>\n        <div class=\"qrcode-wrapper\">\n          <div ref=\"qrcodeRef\">\n            <qrcode-vue :value=\"configForm.hostName\"></qrcode-vue>\n          </div>\n          <div class=\"qrcode-config\">\n            <t-form\n              ref=\"configFormRef\"\n              :model=\"configForm\"\n              :rules=\"configRules\"\n            >\n              <t-form-item\n                label=\"域名\"\n                prop=\"hostName\"\n              >\n                <t-input v-model=\"configForm.hostName\"></t-input>\n              </t-form-item>\n            </t-form>\n            <t-button\n              style=\"margin-top: 10px\"\n              @click=\"generateImg\"\n            >\n              保存二维码\n            </t-button>\n          </div>\n        </div>\n      </t-card>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport qrcodeVue from 'qrcode.vue';\n/* in ES 6 */\nimport domtoimage from 'dom-to-image';\nimport { defineComponent, ref } from 'vue';\nimport { urlToBlob } from '@/utils/transfer2blob';\n\nexport default defineComponent({\n  components: {\n    qrcodeVue\n  },\n  setup() {\n    const qrcodeImgSrc = ref();\n    const qrcodeRef = ref();\n    const configFormRef = ref();\n    const value = ref('https://example.com');\n    const configRules = {\n      hostName: [\n        { required: true, message: '请输入二维码链接', trigger: 'blur' }\n      ]\n    };\n    const configForm = ref({\n      hostName: 'https://example.com'\n    });\n\n    /**\n     * @description 下载图片\n     */\n    const handleDownImg = () => {\n      urlToBlob(qrcodeImgSrc.value, (res: any) => {\n        const link = document.createElement('a');\n        const href = window.URL.createObjectURL(res); // 创建下载的链接\n        link.href = href;\n        link.download = 'Download.png';\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      });\n      ElMessage.success('保存成功！');\n    };\n\n    /**\n     * @description 生成海报图片\n     * @param\n     */\n    const generateImg = () => {\n      const options = { cacheBust: true, width: 375, bgcolor: '#fff' };\n      domtoimage\n        .toBlob(qrcodeRef.value, options)\n        .then((blob: Blob) => {\n          const reader = new FileReader();\n          reader.onload = e => {\n            qrcodeImgSrc.value = e?.target?.result;\n            handleDownImg();\n          };\n          if (blob) {\n            reader.readAsDataURL(blob);\n          }\n        })\n        .catch((error: any) => {\n          // eslint-disable-next-line no-console\n          console.error('oops, something went wrong!', error);\n        });\n    };\n\n    return {\n      qrcodeRef,\n      value,\n      configFormRef,\n      configForm,\n      configRules,\n      generateImg\n    };\n  }\n});\n</script>\n<style lang=\"less\" scoped>\n.qrcode-container {\n  margin-top: 20px;\n  .info {\n    padding-left: 20px;\n    margin-bottom: 20px;\n    font-size: 12px;\n    text-align: left;\n  }\n  .qrcode-wrapper {\n    display: flex;\n    width: 100%;\n    flex-direction: row;\n    justify-content: space-around;\n    align-items: center;\n    .qrcode-config {\n      width: 70%;\n      text-align: center;\n    }\n  }\n}\n</style>\n"],"names":["urlToBlob","theUrl","callback","xhr","XMLHttpRequest","open","responseType","onload","this","status","response","send","_sfc_main","defineComponent","components","qrcodeVue","[object Object]","qrcodeImgSrc","ref","qrcodeRef","configFormRef","value","configForm","hostName","configRules","required","message","trigger","generateImg","domtoimage","toBlob","cacheBust","width","bgcolor","then","blob","reader","FileReader","e","_a","target","result","res","link","document","createElement","href","window","URL","createObjectURL","download","body","appendChild","click","removeChild","ElMessage","success","readAsDataURL","catch","error","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_5","style","text-align","_hoisted_7","class","_component_t_card","__unplugin_components_5","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_t_divider","content-position","default","_withCtx","_","_hoisted_3","_hoisted_4","_hoisted_6","_hoisted_8","_component_qrcode_vue","_hoisted_9","_component_t_form","model","_ctx","_component_t_form_item","label","_component_t_input","_component_t_button","margin-top"],"mappings":"kNAGa,MAAAA,EAAY,CAACC,EAAgBC,KAClC,MAAAC,EAAM,IAAIC,eACZD,EAAAE,KAAK,MAAOJ,GAAQ,GACxBE,EAAIG,aAAe,OACnBH,EAAII,OAAS,WACS,MAAhBC,KAAKC,QACHP,GACFA,EAASM,KAAKE,WAIpBP,EAAIQ,QCoCNC,EAAAC,EAAA,CAA+BC,WAAA,CACjBC,UAAAA,GAEZC,QAEE,MAAAC,EAAAC,IACAC,EAAAD,IACAE,EAAAF,IACAG,EAAAH,EAAA,uBAMAI,EAAAJ,EAAA,CAAuBK,SAAA,wBA4CvB,MAAA,CAAOJ,UAAAA,EACLE,MAAAA,EACAD,cAAAA,EACAE,WAAAA,EACAE,YArDF,CAAoBD,SAAA,CACR,CAAAE,UAAA,EAAAC,QAAA,WAAAC,QAAA,UAqDVC,YAzBF,KAEEC,EAAAC,OAAAX,EAAAE,MADA,CAAAU,WAAA,EAAAC,MAAA,IAAAC,QAAA,SACAC,KAAAC,IAGI,MAAAC,EAAA,IAAAC,WACAD,EAAA7B,OAAA+B,UACErB,EAAAI,MAAA,OAAAkB,EAAA,MAAAD,OAAA,EAAAA,EAAAE,aAAA,EAAAD,EAAAE,OAvBNzC,EAAAiB,EAAAI,MAAAqB,IACE,MAAAC,EAAAC,SAAAC,cAAA,KACAC,EAAAC,OAAAC,IAAAC,gBAAAP,GACAC,EAAAG,KAAAA,EACAH,EAAAO,SAAA,eACAN,SAAAO,KAAAC,YAAAT,GACAA,EAAAU,QACAT,SAAAO,KAAAG,YAAAX,KAEFY,UAAAC,QAAA,UAiBIrB,GACEC,EAAAqB,cAAAtB,KACFuB,MAAAC,YAlGDC,EAAAC,IAAAC,EAAA,mBAAAD,EAAAA,IAAAE,IAAAF,+KAYIG,EAAA,CAAAC,MAAA,CAAAC,aAAA,oDAIEC,EAAA,CAAAC,MAAA,yJAjBbC,EAAAC,EAEI,OAAAC,IAAAC,EAAA,MAAAC,EAAA,CAA4BC,EAAA,MAAAC,EAAA,CAAYC,EAAAC,EAAA,CAAAC,mBAAA,QAAA,CAAAC,QAAAC,EAAA,IAAA,cACxCC,EAAA,IAIFC,IAKUR,EAAA,MAAAS,EAAA,CAAAP,EAAAP,EAAA,CAAAD,MAAA,YAAA,CAAAW,QAAAC,EAAA,IAAA,CAFsBN,EAAA,MAAAV,EAAA,CACHoB,EAEzBR,EAAAC,KAE0DH,EAAA,MAAAP,EAAA,CAAAO,EAAA,MAAAW,EAAA,CAAfT,EAAAU,EAAA,8BAEzC,KAAA,EAAA,CAAA,WAAA,KAYWZ,EAAA,MAAAa,EAAA,CAVYX,EAAAY,EAAA,CACDtE,IAAA,gBACZuE,MAAAC,EAAApE,gDAGMsD,EAAAe,EAAA,CACKC,MAAA,uBAEGb,QAAAC,EAAA,IAAA,CAAAJ,EAAAiB,EAAA,kIAGtBZ,EAAA,GAAA,EAAA,CAAA,QAAA,UAC0BL,EAAAkB,EAAA,CACL7B,MAAA,CAAA8B,aAAA"}
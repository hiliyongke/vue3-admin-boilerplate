import{d as e,c as d,a as o,y as n,x as l,P as t,o as a,N as i,w as c,bx as s,t as r,s as u,g as p,m as N,e as h,u as v,A as m,J as b,R as f,C as y,E as x,H as k,W as I,F as w,r as _,n as g,I as V}from"./.pnpm-86d57c44.js";import{_ as C}from"./index-d48c677b.js";const O={class:"add-node-btn-box"},M={class:"add-node-btn"},j={class:"popover-inner-content"},F=o("button",{class:"btn"},[o("span",null,"+")],-1),J=C(e({__name:"add-node-btn",props:{node:{type:Object,default:()=>{}},addNode:{type:Function,default:()=>null}},setup(e){const i=e,c=e=>{i.addNode({nodeId:i.node.nodeId,type:e})};return(e,i)=>{const s=t;return a(),d("div",O,[o("div",M,[n(s,null,{content:l(()=>[o("div",j,[o("div",{onClick:i[0]||(i[0]=e=>c("approver"))},"审批人"),o("div",{onClick:i[1]||(i[1]=e=>c("notifier"))},"抄送人"),o("div",{onClick:i[2]||(i[2]=e=>c("branch"))},"条件分支")])]),default:l(()=>[F]),_:1})])])}}}),[["__file","/home/runner/work/vue3-admin-boilerplate/vue3-admin-boilerplate/src/components/basic/workflow/add-node-btn.vue"]]),S={class:"col-box"},B={key:0,class:"top-left-cover-line"},z={key:1,class:"bottom-left-cover-line"},L={class:"condition-node"},U={class:"condition-node-box"},D={class:"auto-judge"},A={class:"title-wrapper"},E={class:"editable-title"},H={class:"priority-title"},P=[o("div",{class:"content"},"请设置条件",-1)],R={key:3,class:"top-right-cover-line"},W={key:4,class:"bottom-right-cover-line"},$=C(e({__name:"col-box",props:{node:{type:Object,default:()=>null},index:{type:Number},parentLength:{type:Number},addNode:{type:Function,default:()=>null},deleteNode:{type:Function,default:()=>null}},emits:["delBranch"],setup(e,{emit:l}){const t=()=>{};return(p,N)=>(a(),d("div",S,[0===e.index?(a(),d("div",B)):i("v-if",!0),0===e.index?(a(),d("div",z)):i("v-if",!0),o("div",L,[o("div",U,[o("div",D,[o("div",A,[o("span",E,[c(o("input",{"onUpdate:modelValue":N[0]||(N[0]=d=>e.node.name=d),type:"text"},null,512),[[s,e.node.name]])]),o("span",H,"优先级"+r(e.index+1),1),o("span",{class:"svg-icon close",onClick:N[1]||(N[1]=d=>l("delBranch",e.index))}," 删除 ")]),o("div",{class:"content-wrapper",onClick:t},P)]),n(J,{node:e.node,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])])]),e.node&&e.node.childNode?(a(),u(ne,{key:2,node:e.node.childNode,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])):i("v-if",!0),e.index===e.parentLength-1?(a(),d("div",R)):i("v-if",!0),e.index===e.parentLength-1?(a(),d("div",W)):i("v-if",!0)]))}}),[["__file","/home/runner/work/vue3-admin-boilerplate/vue3-admin-boilerplate/src/components/basic/workflow/col-box.vue"]]),q={class:"node-wrap-box"},G=C(e({__name:"node-wrap-box",props:{node:{type:Object,default:()=>null},deleteNode:{type:Function,default:()=>null}},setup(e){const t=p(!1),c=p({}),s=()=>{t.value=!0,c.value={}};return(p,I)=>{const w=f,_=y,g=x,V=k,C=b;return a(),d("div",q,[o("div",null,[o("div",{class:N(["title",[e.node.type]])},[h(r(e.node.name)+" ",1),o("span",{onClick:I[0]||(I[0]=d=>e.deleteNode(e.node.nodeId))},"删除")],2),o("div",{class:"content",onClick:s}," 所有人 > ")]),n(C,{visible:v(t),"onUpdate:visible":I[1]||(I[1]=e=>m(t)?t.value=e:null),header:e.node.name,width:520,onClose:I[2]||(I[2]=()=>{t.value=!1})},{default:l(()=>[n(V,{ref_key:"ruleForm",ref:c,model:v(c)},{default:l(()=>[n(g,{ref:"name",label:"approver"===e.node.type?"审批人":"抄送人",name:"xx"},{default:l(()=>[n(_,null,{default:l(()=>[n(w,{value:1},{default:l(()=>[h("指定成员")]),_:1}),"notifier"!==e.node.type?(a(),u(w,{key:0,value:2},{default:l(()=>[h(" 指定岗位 ")]),_:1})):i("v-if",!0),n(w,{value:3},{default:l(()=>[h("发起人主管")]),_:1})]),_:1})]),_:1},8,["label"]),n(g,{ref:"name",label:"审批方式",name:"name"},{default:l(()=>[n(_,null,{default:l(()=>[n(w,{value:"a"},{default:l(()=>[h("会审")]),_:1}),n(w,{value:"b"},{default:l(()=>[h("或审")]),_:1})]),_:1})]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible","header"])])}}}),[["__file","/home/runner/work/vue3-admin-boilerplate/vue3-admin-boilerplate/src/components/basic/workflow/node-wrap-box.vue"]]),K={key:0,class:"branch-and-node-wrap"},Q={class:"branch-wrap"},T={class:"branch-wrap-box"},X={class:"branch-box"},Y={key:0},Z={key:1,class:"node-wrap"},ee={key:0,class:"branch-wrap-box"},de={class:"branch-wrap-box"},oe={class:"branch-box"},ne=C(e({__name:"node-main",props:{node:{type:Object,default:()=>null},addNode:{type:Function,default:()=>null},deleteNode:{type:Function,default:()=>null}},setup(e){const l=e,t=e=>{e.conditionNodes.push({name:"条件"+(e.conditionNodes.length+1),type:"condition",prevId:e.nodeId,nodeId:Math.floor((Math.random()+Math.floor(9*Math.random()+1))*Math.pow(10,9))})},c=(e,d)=>{if(e.conditionNodes.length<=2)l.deleteNode(e.nodeId);else if(e.conditionNodes.splice(d,1),e.conditionNodes[d].childNode){const o=e.conditionNodes[d].childNode||null;e.conditionNodes.splice(d,1),!e.conditionNodes[0].childNode&&o&&(e.conditionNodes[0].childNode=o)}};return(l,s)=>{const r=I("node-main",!0);return e.node&&e.node.nodeId&&e.node.childNode&&e.node.conditionNodes?(a(),d("div",K,[o("div",Q,[o("div",T,[o("div",X,[o("button",{class:"add-branch",onClick:s[0]||(s[0]=d=>t(e.node))}," 添加条件 "),(a(!0),d(w,null,_(e.node.conditionNodes,(d,o)=>(a(),u($,{key:d.nodeId,index:o,node:d,"add-node":e.addNode,"delete-node":e.deleteNode,"parent-length":e.node.conditionNodes.length,onDelBranch:s[1]||(s[1]=d=>c(e.node,d))},null,8,["index","node","add-node","delete-node","parent-length"]))),128))]),n(J,{node:e.node,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])])]),"branch"===e.node.childNode.type?(a(),d("div",Y,[n(r,{node:e.node.childNode,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])])):(a(),d("div",Z,[n(G,{node:e.node.childNode,"delete-node":e.deleteNode},null,8,["node","delete-node"]),n(J,{node:e.node.childNode,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"]),e.node.childNode.childNode?(a(),u(r,{key:0,node:e.node.childNode.childNode,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])):i("v-if",!0)]))])):e.node&&e.node.nodeId?(a(),d("div",{key:1,class:N(["branch"===e.node.type?"branch-wrap":"node-wrap"])},["branch"===e.node.type?(a(),d("div",ee,[o("div",de,[o("div",oe,[o("button",{class:"add-branch",onClick:s[2]||(s[2]=d=>t(e.node))}," 添加条件 "),(a(!0),d(w,null,_(e.node.conditionNodes,(d,o)=>(a(),u($,{key:d.nodeId,index:o,node:d,"parent-length":e.node.conditionNodes.length,"add-node":e.addNode,"delete-node":e.deleteNode,onDelBranch:s[3]||(s[3]=d=>c(e.node,d))},null,8,["index","node","parent-length","add-node","delete-node"]))),128))]),n(J,{node:e.node,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])])])):(a(),u(G,{key:1,node:e.node,"delete-node":e.deleteNode},null,8,["node","delete-node"])),"branch"!==e.node.type?(a(),u(J,{key:2,node:e.node,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])):i("v-if",!0),e.node.childNode?(a(),u(r,{key:3,node:e.node.childNode,"add-node":e.addNode,"delete-node":e.deleteNode},null,8,["node","add-node","delete-node"])):i("v-if",!0)],2)):i("v-if",!0)}}}),[["__file","/home/runner/work/vue3-admin-boilerplate/vue3-admin-boilerplate/src/components/basic/workflow/node-main.vue"]]),le={class:"container"},te={style:{position:"absolute",right:"40px","z-index":"100"}},ae={class:"node-wrap"},ie={class:"node-wrap-box"},ce={class:"title"},se=o("div",{class:"content"},"所有人 >",-1),re=o("div",{class:"end-node"},[o("div",{class:"end-node-circle"}),o("div",{class:"end-node-text"},"流程结束")],-1),ue={class:"submit"},pe=C(e({__name:"index",props:{modelValue:{type:Object,default:()=>{}}},emits:["input"],setup(e,{emit:t}){const c=e,s=()=>Math.floor((Math.random()+Math.floor(9*Math.random()+1))*Math.pow(10,9)),N=p(100),m=p("5"),b=e=>{let d=N.value+e;d>0&&d<=200&&(N.value=d)},f=()=>{w(c.modelValue)},y=e=>{k(c.modelValue,e.nodeId,d=>{if("branch"===e.type){const o=s(),n=[];for(let e=0;e<2;e++)n.push({name:"条件"+(e+1),type:"condition",prevId:o,nodeId:s()});d.childNode={type:e.type,prevId:d.nodeId,nodeId:o,conditionNodes:n},t("input",JSON.parse(JSON.stringify(c.modelValue)))}else{const o={type:e.type,name:"approver"===e.type?"审批人":"抄送人",prevId:d.nodeId,nodeId:s()};d.childNode&&(o.childNode=Object.assign({},d.childNode)),d.childNode=o,t("input",JSON.parse(JSON.stringify(c.modelValue)))}})},x=e=>{I(c.modelValue,e),t("input",JSON.parse(JSON.stringify(c.modelValue)))},k=(e,d,o)=>{"branch"===e.type?(e.nodeId===d?o(e):e.childNode&&k(e.childNode,d,o),e.conditionNodes.map(e=>{e.nodeId===d?o(e):e.childNode&&k(e.childNode,d,o)})):e.nodeId===d?o(e):e.childNode&&k(e.childNode,d,o)},I=(e,d)=>{if(e.childNode){if(e.childNode.conditionNodes)for(let o in e.childNode.conditionNodes)I(e.childNode.conditionNodes[o],d);if(e.childNode.nodeId===d){var o=e.childNode.childNode||null;delete e.childNode,o&&(e.childNode=o)}else I(e.childNode,d)}},w=e=>{if(e.childNode){if(e.childNode.conditionNodes)for(let d in e.childNode.conditionNodes)w(e.childNode.conditionNodes[d]);w(e.childNode)}};return(t,c)=>{const s=V;return a(),d("div",null,[o("div",le,[o("div",te,[o("button",{style:{width:"50px",height:"50px","font-size":"30px","background-color":"grey","border-radius":"25px"},onClick:c[0]||(c[0]=e=>b(+v(m)))}," + "),o("button",{style:{width:"50px",height:"50px","font-size":"30px","background-color":"grey","border-radius":"25px"},onClick:c[1]||(c[1]=e=>b(-v(m)))}," - ")]),o("div",{style:g(`transform: scale(${v(N)/100})`)},[o("div",ae,[o("div",ie,[o("div",null,[o("div",ce,r(e.modelValue&&e.modelValue.name),1),se])]),n(J,{node:e.modelValue,"add-node":y},null,8,["node"])]),e.modelValue&&e.modelValue.childNode?(a(),u(ne,{key:0,node:e.modelValue.childNode,"add-node":y,"delete-node":x},null,8,["node"])):i("v-if",!0),re,o("div",ue,[n(s,{onClick:f},{default:l(()=>[h("预览")]),_:1})])],4)])])}}}),[["__file","/home/runner/work/vue3-admin-boilerplate/vue3-admin-boilerplate/src/components/basic/workflow/index.vue"]]),Ne=C(e({__name:"index",setup(e){const d=p({name:"发起人",type:"start",nodeId:-1,childNode:{type:"branch",prevId:-1,nodeId:1962370654,conditionNodes:[{name:"条件1",type:"condition",prevId:1962370654,nodeId:8724388758},{name:"条件2",type:"condition",prevId:1962370654,nodeId:6955647539,childNode:{type:"branch",prevId:6955647539,nodeId:6579100235,conditionNodes:[{name:"条件1",type:"condition",prevId:6579100235,nodeId:7943358411},{name:"条件2",type:"condition",prevId:6579100235,nodeId:9245914757}],childNode:{type:"approver",name:"审批人",prevId:6579100235,nodeId:2573062896}}}]}});return(e,o)=>(a(),u(pe,{modelValue:v(d),"onUpdate:modelValue":o[0]||(o[0]=e=>m(d)?d.value=e:null)},null,8,["modelValue"]))}}),[["__file","/home/runner/work/vue3-admin-boilerplate/vue3-admin-boilerplate/src/pages/demo/workflow/index.vue"]]);export{Ne as default};
//# sourceMappingURL=index-eb0253a2.js.map

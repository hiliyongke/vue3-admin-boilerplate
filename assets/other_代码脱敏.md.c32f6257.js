import{_ as s,c as a,o as n,a as l}from"./app.c4e3427c.js";const d=JSON.parse('{"title":"导语","description":"","frontmatter":{},"headers":[{"level":2,"title":"重新拷贝","slug":"重新拷贝","link":"#重新拷贝","children":[]}],"relativePath":"other/代码脱敏.md"}'),p={name:"other/代码脱敏.md"},o=l(`<h1 id="导语" tabindex="-1">导语 <a class="header-anchor" href="#导语" aria-hidden="true">#</a></h1><p>在对外开源，或者代码转交时，对于项目部分敏感文件代码，如数据库账号、密码等必须要脱敏。 因此，以下总结了一下应用开源前脱敏的几种方案</p><blockquote><p>方案一.<br> 另起炉灶</p></blockquote><h2 id="重新拷贝" tabindex="-1">重新拷贝 <a class="header-anchor" href="#重新拷贝" aria-hidden="true">#</a></h2><p>1、原有仓库删除<br> 2、数据脱敏处理<br> 3、建立并上传新仓库</p><ul><li>优点 <ul><li>简单粗暴</li></ul></li><li>缺点 <ul><li>历史提交记录丢失</li></ul></li></ul><blockquote><p>方案二.<br> 优雅脱敏</p></blockquote><ul><li><p>对某个文件进行脱敏命令</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">filter-branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--force</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--index-filter</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">git rm --cached --ignore-unmatch path-of-remove-file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--prune-empty</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tag-name-filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--all</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>参数说明：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">path-of-remove-file</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">是要删除的文件的相对目录</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">相对于git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">repo的根目录</span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">,可以使用通配符</span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">匹配文件进行批量删除.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>然后推送修改结果</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">origin</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>实操如：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">filter-branch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--force</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--index-filter</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">git rm --cached --ignore-unmatch .-env</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--prune-empty</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tag-name-filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--all</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>当看到类似于下面的提示信息说明删除成功了</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">Rewrite</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">75d09816e8a5e48d3f633b5b4545259b055ab1c6</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">/</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> seconds passed, remaining </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> predicted</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.env</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">Ref</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">refs/heads/master</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">was</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rewritten</span></span>
<span class="line"><span style="color:#FFCB6B;">Ref</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">refs/remotes/origin/master</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">was</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rewritten</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>project 目录下的 env 文件就脱敏了。<br><strong>注意 ：这里的文件同时也会被删除 。操作前可以拷贝一份新文件, 且进行脱敏处理即可</strong></p></li><li><p>优点</p><ul><li>保留了其它非脱敏文件的历史提交记录</li></ul></li><li><p>缺点</p><ul><li>相对来说复杂了点</li></ul></li></ul>`,8),e=[o];function t(c,r,C,i,y,D){return n(),a("div",null,e)}const F=s(p,[["render",t]]);export{d as __pageData,F as default};
